var greetingModule=function(){var e=new Date,t=Math.floor(e.getHours()/6),a=$(".greeting-text"),i=["Good night, ","Good morning, ","Good afternoon, ","Good evening, "];a.html(i[t])}(),migAlert=function(){function e(e,a,i){t();var a=a||"info",r=$('<div class="alert '+a+'"> <p class="alert-message">'+e+'</p> <button class="alert-close-btn button" type="button"><i class="icon-close"></i></button></div>');r.appendTo("body"),r.css({right:-r.width()}).animate({right:0},300),i>0&&setTimeout(function(){t(r)},i)}function t(e){var e=e||$(".alert");e.animate({marginTop:60,opacity:0},100,function(){e.hide()})}return $(document).on("click",".alert-close-btn",function(){var e=$(this).closest(".alert");t(e)}),{show:e}}();$(function(){migTabs.init()}),$(window).resize(function(){migTabs.tabsResize()});var mig={init:function(){mig.tabsContainer=$(".mig-tabs"),mig.menu=$(".mig-tab-link"),mig.framesContainer=$(".mig-frame-content"),mig.dashboard=mig.menu.filter('a[name="Dashboard"]'),mig.setup()},setup:function(){mig.menu.click(function(e){var t=$(this);e.preventDefault?e.preventDefault():e.returnValue=!1;var a=$(this).attr("name"),i=$(this).attr("href");t.data("tab")?mig.tabPress(t.data("tab")):(t.tab=mig.tabCreate(a,i,t),t.data("tab",t.tab))}),mig.dashboard.trigger("click"),$(".main-logo").click(function(){mig.dashboard.trigger("click")})},tabCreate:function(e,t,a){var i=$("<li/>",{name:e});$("<a/>",{href:t,append:$("<span/>").text(e),title:e,click:function(){return mig.tabPress(i),!1}}).appendTo(i),$("<button/>",{"class":"mig-close-tab",type:"button",html:'<i class="icon-tab-close"></i>',click:function(){mig.tabClose(i)}}).appendTo(i);i.css({top:"50px"}).animate({top:0},100);var r=mig.frameCreate(e,t);return i.data("active-frame",r),i.frames=[],i.frames.push(r),a?(i.appendTo(mig.tabsContainer),i.data("menu",a),mig.tabPress(i)):i.insertAfter(mig.currentTab),i},tabPress:function(e){self=this,mig.makeElementActive(e),mig.makeMenuActive(e.data("menu")),mig.currentTab=e,mig.tabsResize(),mig.frameShow(e.data("active-frame"))},tabClose:function(e){var t=mig.tabsContainer.children("li");if(e.is(mig.currentTab)&&t.length>1){var a=e.next().length>0?e.next():e.prev();mig.tabPress(a)}e.data("menu")&&e.data("menu").removeData("tab"),mig.removeElementArray(e.frames),e.remove(),mig.tabsResize(),1==t.length&&mig.dashboard.trigger("click")},tabSetActiveFrame:function(e){mig.currentTab.data("active-frame",e)},tabAddFrame:function(e){mig.currentTab.frames.push(e)},tabsResize:function(){var e=mig.tabsContainer.find("li").not(".active"),t=mig.tabsContainer.find("li"),a=160,i=mig.tabsContainer.width()-a;t.outerWidth(i/e.length)},frameCreate:function(e,t,a){var i=$("<iframe/>",{src:t,name:e}).appendTo(mig.framesContainer);return i.link=t,i.name=e,a&&(i.parentFrame=a,a.childFrame=i,mig.makeElementActive(i)),mig.frameInitContent(i),mig.currentFrame=i,i},frameInitContent:function(e){e.load(function(){mig.insetsContainer=e.contents().find(".mig-breadcrumbs"),e.parentFrames=[],e.childFrames=[],mig.initialFrame=e,mig.frameSetParentArray(e),mig.frameInitInsets(e),mig.insetButtonInit(e)})},insetButtonInit:function(e){if(null!=e){var t=(e.contents().find(".mig-inset-btn"),e.contents().find("body"));t.on("click",".mig-inset-btn",function(e){if("_blank"!=$(this).attr("target")){e.preventDefault?e.preventDefault():e.returnValue=!1;var t=$(e.target).hasClass(".mig-inset-btn")?$(e.target):$(e.target).closest(".mig-inset-btn"),a=t.attr("name"),i=t.attr("href")||t.data("href"),r=mig.currentTab.data("active-frame");if(e.ctrlKey){var n=mig.tabCreate(a,i);n.sourceFrame=r}else{var s=mig.frameCreate(a,i,r);mig.tabSetActiveFrame(s),mig.tabAddFrame(s)}return!1}})}},frameShow:function(e){mig.makeElementActive(e),mig.currentFrame=e},frameInitInsets:function(e){var t=e.parentFrames.reverse();t.push(e),jQuery.each(t,function(e,t){var a=$("<a/>",{src:t.link,name:t.name,append:t.name,click:function(){mig.frameShow(t),mig.tabSetActiveFrame(t),mig.frameSetChildArray(t),mig.removeElementArray(mig.currentFrame.childFrames)}});$("<li></li>").append(a).appendTo(mig.insetsContainer)})},frameReload:function(e){e.attr("src",e.link)},frameReloadWithNewUrl:function(e,t,a){var a=a?a:0;setTimeout(function(){e.attr("src",t)},a)},frameSetParentArray:function(e){e.parentFrame&&(mig.initialFrame.parentFrames.push(e.parentFrame),mig.frameSetParentArray(e.parentFrame))},frameSetChildArray:function(e){e.childFrame&&(mig.currentFrame.childFrames.push(e.childFrame),mig.frameSetChildArray(e.childFrame))},insetClose:function(e){e.remove(),mig.tabSetActiveFrame(e.parentFrame),mig.frameReload(e.parentFrame),mig.frameShow(e.parentFrame)},pageClose:function(){var e=mig.currentFrame,t=mig.currentTab;e.parentFrame?mig.insetClose(e):mig.tabClose(t)},makeMenuActive:function(e){mig.menu.removeClass("active"),e&&!e.is(mig.dashboard)&&e.addClass("active")},makeElementActive:function(e){e.siblings().removeClass("active"),e.addClass("active")},removeElementArray:function(e){jQuery.each(e,function(e,t){t.remove()})},reloadCurrentFrame:function(){mig.frameReload(mig.currentFrame)},reloadCurrentFrameWithNewUrl:function(e,t){mig.frameReloadWithNewUrl(mig.currentFrame,e,t)},reloadSourceFrameWithNewUrl:function(e){mig.currentTab.sourceFrame?mig.frameReload(mig.currentTab.sourceFrame):mig.parentFramesReloadWithNewUrl(mig.currentFrame,e)},reloadSourceFrame:function(){mig.currentTab.sourceFrame?mig.frameReload(mig.currentTab.sourceFrame):mig.parentFramesReload(mig.currentFrame)},parentFramesReload:function(e){e.parentFrame&&(mig.frameReload(e.parentFrame),mig.parentFramesReload(e.parentFrame))},parentFramesReloadWithNewUrl:function(e,t){e.parentFrame&&(mig.frameReloadWithNewUrl(e.parentFrame,t),mig.parentFramesReloadWithNewUrl(e.parentFrame))}},migTabs=Object.create(mig),clipboardModule=function(){function e(){var e=$(".mig-clipboard"),t=e.find(".show-clipboard-btn");t.find("i").removeClass("icon-angle-up").addClass("icon-angle-down"),e.addClass("visible"),$(".mig-frame-content").animate({paddingBottom:e.height()},200)}function t(){var e=$(".mig-clipboard"),t=e.find(".show-clipboard-btn");t.find("i").removeClass("icon-angle-down").addClass("icon-angle-up"),e.removeClass("visible"),$(".mig-frame-content").animate({paddingBottom:0},200)}function a(){var e=$(".mig-clipboard"),a=e.find(".show-clipboard-btn");a.find(".counter").text("("+e.find(".clipboard-asset").length+")"),0==e.find(".clipboard-asset").length&&t()}return $(document).on("click",".show-clipboard-btn",function(){$(".mig-clipboard").hasClass("visible")?t():e()}),{show:e,hide:t,setLength:a}}(),migAsset={clipboardAssetArray:[],triggerAsset:function(e){var t=this,a=migTabs.currentFrame.contents().find(".asset-list > .asset[data-id="+e+"]");t.createAsset(a)},createAsset:function(e){var t=this,a=$(e).is(".asset")?$(e):$(e).closest(".asset");if(t.inClipboard(a.data("id"))>=0)return void clipboardModule.show();var i={type:a.data("type"),id:a.data("id"),image:a.find(".asset-image").attr("src"),name:a.find(".asset-name").text(),size:a.find(".asset-size").text(),date:a.find(".asset-date").text(),format:a.find(".asset-format").text()};t.inClipboard(i.id),a.data("asset",i),t.addToClipboard(i)},addToClipboard:function(e){var t=this,a=$(".clipboard-asset-list"),i=$('<li class="clipboard-asset" data-type="'+e.type+'"><button type="button" class="button remove-asset-btn"><i class="icon-close"></i></button><figure class="asset-view"><img class="asset-image" src="" alt=""></figure><div class="asset-details"><p class="asset-name"></p><p class="asset-size"></p><p class="asset-date"></p></div></li>');i.find(".asset-image").attr("src",e.image),i.find(".asset-name").text(e.name),i.find(".asset-size").text(e.size),i.find(".asset-date").text(e.date),i.find(".remove-asset-btn").click(function(){t.removeFromClipboard(e)}),"file"!=e.type&&"video"!=e.type||i.find(".asset-view").append('<span class="asset-format">'+e.format+"</span>"),"template"==e.type&&i.find(".asset-name").html("Template </br>#"+e.id),e.clipboardContainer=i,i.data("asset",e),a.append(i),t.clipboardAssetArray.push(e.id),clipboardModule.show(),clipboardModule.setLength(),t.initAssetDrag(e)},removeFromClipboard:function(e){var t=this;e.clipboardContainer.remove(),clipboardModule.setLength(),t.clipboardAssetArray.splice($.inArray(e.id,t.clipboardAssetArray),1),delete e},initAssetDrag:function(e){var t=this;e.clipboardContainer.draggable({addClasses:!1,appendTo:"body",revert:"invalid",cursorAt:{top:1,left:1},cursor:"move",iframeFix:!0,iframeOffset:migTabs.currentFrame.offset(),helper:function(){return $('<div class="draggable-asset" data-type="'+e.type+'"></div>').append("<div>"+$(this).html()+"</div>")},start:function(){t.initDroppers(e),$("body").css({overflow:"hidden"}),$(this).css({opacity:.5})},stop:function(){$("body").css({overflow:""}),$(this).css({opacity:1})},cancel:function(){$(this).css({opacity:1})}})},initDroppers:function(e){var t=migTabs.currentFrame.contents().find('.dropper[data-type="'+e.type+'"], .dropper[data-type="file"]');if("image"==e.type)var t=t.add(migTabs.currentFrame.contents().find('.mce-window[aria-label="Insert/edit image"] .mce-first.mce-formitem .mce-textbox'));e&&t.droppable({disabled:!1}),t.droppable({addClasses:!1,activeClass:"active",hoverClass:"hover",iframeFix:!0,iframeOffset:migTabs.currentFrame.offset(),drop:function(){var t=$(this);t.is("input")?migTabs.currentFrame[0].contentWindow.mceuImageModule.dropAssetInInput(t,e):migTabs.currentFrame[0].contentWindow.$(this).trigger("drop",e)},deactivate:function(){$(this).droppable({disabled:!0})}})},inClipboard:function(e){var t=this;return $.inArray(e,t.clipboardAssetArray)}},sidebarMenuController=function(){function e(e){i=$(e).closest("li").find(".sub-menu"),i.length&&i.offset().top+i.height()>t.offset().top+t.height()&&i.addClass("to-top")}var t=$(".sidebar"),a=$(".sidebar").find(".main-menu"),i=(a.find(".menu-primary-link"),a.find(".sub-menu"));$(document).on("mouseenter",".sidebar .main-menu .menu-primary-link, .sidebar .main-menu .sub-menu",function(t){t.preventDefault(),e(this)}),$(document).on("mouseleave",".sidebar .main-menu .menu-primary-link, .sidebar .main-menu .sub-menu",function(e){e.preventDefault(),i.removeClass("to-top")})}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2luLmpzIiwibWlnLWFsZXJ0LmpzIiwibWlnLXRhYnMuanMiLCJtaWctYXNzZXRzLmpzIiwibWlnLW1lbnUuanMiXSwibmFtZXMiOlsiZ3JlZXRpbmdNb2R1bGUiLCJub3ciLCJEYXRlIiwidGltZXNPZkRheSIsIk1hdGgiLCJmbG9vciIsImdldEhvdXJzIiwiZ3JlZXRpbmdFbGVtZW50IiwiJCIsImdyZWV0aW5nc0FyciIsImh0bWwiLCJtaWdBbGVydCIsInNob3dBbGVydCIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJ0aW1lIiwiY2xvc2VBbGVydCIsImFsZXJ0IiwiYXBwZW5kVG8iLCJjc3MiLCJyaWdodCIsIndpZHRoIiwiYW5pbWF0ZSIsInNldFRpbWVvdXQiLCJtYXJnaW5Ub3AiLCJvcGFjaXR5IiwiaGlkZSIsImRvY3VtZW50Iiwib24iLCJ0aGlzIiwiY2xvc2VzdCIsInNob3ciLCJtaWdUYWJzIiwiaW5pdCIsIndpbmRvdyIsInJlc2l6ZSIsInRhYnNSZXNpemUiLCJtaWciLCJ0YWJzQ29udGFpbmVyIiwibWVudSIsImZyYW1lc0NvbnRhaW5lciIsImRhc2hib2FyZCIsImZpbHRlciIsInNldHVwIiwiY2xpY2siLCJldmVudCIsImN1cnJlbnRNZW51IiwicHJldmVudERlZmF1bHQiLCJyZXR1cm5WYWx1ZSIsIm5hbWUiLCJhdHRyIiwibGluayIsImRhdGEiLCJ0YWJQcmVzcyIsInRhYiIsInRhYkNyZWF0ZSIsInRyaWdnZXIiLCJocmVmIiwiYXBwZW5kIiwidGV4dCIsInRpdGxlIiwiY2xhc3MiLCJ0eXBlIiwidGFiQ2xvc2UiLCJ0b3AiLCJ0YWJGcmFtZSIsImZyYW1lQ3JlYXRlIiwiZnJhbWVzIiwicHVzaCIsImluc2VydEFmdGVyIiwiY3VycmVudFRhYiIsInNlbGYiLCJtYWtlRWxlbWVudEFjdGl2ZSIsIm1ha2VNZW51QWN0aXZlIiwiZnJhbWVTaG93IiwidGFicyIsImNoaWxkcmVuIiwiaXMiLCJsZW5ndGgiLCJ0YXJnZXRUYWIiLCJuZXh0IiwicHJldiIsInJlbW92ZURhdGEiLCJyZW1vdmVFbGVtZW50QXJyYXkiLCJyZW1vdmUiLCJ0YWJTZXRBY3RpdmVGcmFtZSIsImZyYW1lIiwidGFiQWRkRnJhbWUiLCJ0YWJzTm90QWN0aXZlIiwiZmluZCIsIm5vdCIsIkFDVElWRV9UQUJfV0lEVEgiLCJ0YWJzQ29udGFpbmVyV2lkdGgiLCJvdXRlcldpZHRoIiwicGFyZW50Iiwic3JjIiwicGFyZW50RnJhbWUiLCJjaGlsZEZyYW1lIiwiZnJhbWVJbml0Q29udGVudCIsImN1cnJlbnRGcmFtZSIsImxvYWQiLCJpbnNldHNDb250YWluZXIiLCJjb250ZW50cyIsInBhcmVudEZyYW1lcyIsImNoaWxkRnJhbWVzIiwiaW5pdGlhbEZyYW1lIiwiZnJhbWVTZXRQYXJlbnRBcnJheSIsImZyYW1lSW5pdEluc2V0cyIsImluc2V0QnV0dG9uSW5pdCIsImJvZHkiLCJjdXJyZW50SW5zZXRCdXR0b24iLCJ0YXJnZXQiLCJoYXNDbGFzcyIsImluc2V0TmFtZSIsImluc2V0TGluayIsInNvdXJjZUZyYW1lIiwiY3RybEtleSIsInRhcmdldEZyYW1lIiwiaW5zZXRzIiwicmV2ZXJzZSIsImpRdWVyeSIsImVhY2giLCJpIiwiaW5zZXRGcmFtZSIsImluc2V0IiwiZnJhbWVTZXRDaGlsZEFycmF5IiwiZnJhbWVSZWxvYWQiLCJmcmFtZVJlbG9hZFdpdGhOZXdVcmwiLCJ1cmwiLCJpbnNldENsb3NlIiwicGFnZUNsb3NlIiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsImVsZW1lbnQiLCJzaWJsaW5ncyIsImVsZW1lbnRzIiwiaW5kZXgiLCJyZWxvYWRDdXJyZW50RnJhbWUiLCJyZWxvYWRDdXJyZW50RnJhbWVXaXRoTmV3VXJsIiwicmVsb2FkU291cmNlRnJhbWVXaXRoTmV3VXJsIiwicGFyZW50RnJhbWVzUmVsb2FkV2l0aE5ld1VybCIsInJlbG9hZFNvdXJjZUZyYW1lIiwicGFyZW50RnJhbWVzUmVsb2FkIiwiT2JqZWN0IiwiY3JlYXRlIiwiY2xpcGJvYXJkTW9kdWxlIiwic2hvd0NsaXBib2FyZCIsImNsaXBib2FyZCIsImNsaXBib2FyZEJ0biIsInBhZGRpbmdCb3R0b20iLCJoZWlnaHQiLCJoaWRlQ2xpcGJvYXJkIiwic2V0Q2xpcGJvYXJkTGVuZ3RoIiwic2V0TGVuZ3RoIiwibWlnQXNzZXQiLCJjbGlwYm9hcmRBc3NldEFycmF5IiwidHJpZ2dlckFzc2V0IiwiaWQiLCJjcmVhdGVBc3NldCIsImFzc2V0Q29udGFpbmVyIiwiaW5DbGlwYm9hcmQiLCJhc3NldCIsImltYWdlIiwic2l6ZSIsImRhdGUiLCJmb3JtYXQiLCJhZGRUb0NsaXBib2FyZCIsImNsaXBib2FyZEFzc2V0TGlzdCIsImNsaXBib2FyZEFzc2V0Q29udGFpbmVyIiwicmVtb3ZlRnJvbUNsaXBib2FyZCIsImNsaXBib2FyZENvbnRhaW5lciIsImluaXRBc3NldERyYWciLCJzcGxpY2UiLCJpbkFycmF5IiwiZHJhZ2dhYmxlIiwiYWRkQ2xhc3NlcyIsInJldmVydCIsImN1cnNvckF0IiwibGVmdCIsImN1cnNvciIsImlmcmFtZUZpeCIsImlmcmFtZU9mZnNldCIsIm9mZnNldCIsImhlbHBlciIsInN0YXJ0IiwiaW5pdERyb3BwZXJzIiwib3ZlcmZsb3ciLCJzdG9wIiwiY2FuY2VsIiwiZHJvcHBlcnMiLCJhZGQiLCJkcm9wcGFibGUiLCJkaXNhYmxlZCIsImFjdGl2ZUNsYXNzIiwiaG92ZXJDbGFzcyIsImRyb3AiLCJkcm9wcGVyIiwiY29udGVudFdpbmRvdyIsIm1jZXVJbWFnZU1vZHVsZSIsImRyb3BBc3NldEluSW5wdXQiLCJkZWFjdGl2YXRlIiwic2lkZWJhck1lbnVDb250cm9sbGVyIiwidG9Ub3AiLCJzdWJNZW51Iiwic2lkZWJhciIsIm1haW5NZW51Il0sIm1hcHBpbmdzIjoiQUFBQSxHQUFBQSxnQkFBQSxXQUNBLEdBQUFDLEdBQUEsR0FBQUMsTUFDQUMsRUFBQUMsS0FBQUMsTUFBQUosRUFBQUssV0FBQSxHQUNBQyxFQUFBQyxFQUFBLGtCQUNBQyxHQUFBLGVBQUEsaUJBQUEsbUJB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QXFLLFFBQUFoQixFQUFBdEYsRUFBQW9GLHVCQ3ZNQThDLHNCQUFBLFdBZ0JBLFFBQUFDLEdBQUFyRSxHQUNBc0UsRUFBQW5NLEVBQUE2SCxHQUFBdkcsUUFBQSxNQUFBMkQsS0FBQSxhQUVBa0gsRUFBQTdILFFBQUE2SCxFQUFBckIsU0FBQXRILElBQUEySSxFQUFBckQsU0FBQXNELEVBQUF0QixTQUFBdEgsSUFBQTRJLEVBQUF0RCxVQUNBcUQsRUFBQXZFLFNBQUEsVUFuQkEsR0FBQXdFLEdBQUFwTSxFQUFBLFlBQ0FxTSxFQUFBck0sRUFBQSxZQUFBaUYsS0FBQSxjQUVBa0gsR0FEQUUsRUFBQXBILEtBQUEsc0JBQ0FvSCxFQUFBcEgsS0FBQSxhQUVBakYsR0FBQW1CLFVBQUFDLEdBQUEsYUFBQSx3RUFBQSxTQUFBaUIsR0FDQUEsRUFBQUUsaUJBQ0EySixFQUFBN0ssUUFHQXJCLEVBQUFtQixVQUFBQyxHQUFBLGFBQUEsd0VBQUEsU0FBQWlCLEdBQ0FBLEVBQUFFLGlCQUNBNEosRUFBQXhFLFlBQUEiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBncmVldGluZ01vZHVsZSA9IChmdW5jdGlvbigpe1xyXG5cdHZhciBub3cgPSBuZXcgRGF0ZSgpLFxyXG5cdFx0dGltZXNPZkRheSA9IE1hdGguZmxvb3Iobm93LmdldEhvdXJzKCkgLyA2KSxcclxuXHRcdGdyZWV0aW5nRWxlbWVudCA9ICQoJy5ncmVldGluZy10ZXh0JyksXHJcblx0XHRncmVldGluZ3NBcnIgPSBbXCJHb29kIG5pZ2h0LCBcIiwgXCJHb29kIG1vcm5pbmcsIFwiLCBcIkdvb2QgYWZ0ZXJub29uLCBcIiwgXCJHb29kIGV2ZW5pbmcsIFwiXTtcclxuXHRncmVldGluZ0VsZW1lbnQuaHRtbChncmVldGluZ3NBcnJbdGltZXNPZkRheV0pO1xyXG59KSgpOyIsInZhciBtaWdBbGVydCA9IChmdW5jdGlvbigpe1xyXG5cclxuXHQkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmFsZXJ0LWNsb3NlLWJ0bicsIGZ1bmN0aW9uKCl7XHJcblx0XHR2YXIgYWxlcnQgPSAkKHRoaXMpLmNsb3Nlc3QoJy5hbGVydCcpO1xyXG5cdFx0Y2xvc2VBbGVydChhbGVydCk7XHJcblx0fSk7XHJcblxyXG5cdGZ1bmN0aW9uIHNob3dBbGVydChtZXNzYWdlLCBzdGF0dXMsIHRpbWUpe1xyXG5cdFx0Y2xvc2VBbGVydCgpO1xyXG5cclxuXHRcdHZhciBzdGF0dXMgPSBzdGF0dXMgfHwgJ2luZm8nLFxyXG5cdFx0XHRhbGVydCA9ICQoJzxkaXYgY2xhc3M9XCJhbGVydCAnICsgc3RhdHVzICsgJ1wiPiA8cCBjbGFzcz1cImFsZXJ0LW1lc3NhZ2VcIj4nKyBtZXNzYWdlICsnPC9wPiA8YnV0dG9uIGNsYXNzPVwiYWxlcnQtY2xvc2UtYnRuIGJ1dHRvblwiIHR5cGU9XCJidXR0b25cIj48aSBjbGFzcz1cImljb24tY2xvc2VcIj48L2k+PC9idXR0b24+PC9kaXY+Jyk7XHJcblx0XHRcclxuXHRcdGFsZXJ0LmFwcGVuZFRvKCdib2R5Jyk7XHJcblx0XHRhbGVydC5jc3Moe3JpZ2h0OiAtYWxlcnQud2lkdGgoKX0pLmFuaW1hdGUoe3JpZ2h0OiAwfSwgMzAwKTtcclxuXHJcblx0XHRpZiAodGltZSA+IDApXHJcblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRjbG9zZUFsZXJ0KGFsZXJ0KTtcclxuXHRcdFx0fSwgdGltZSk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBjbG9zZUFsZXJ0KGFsZXJ0KXtcclxuXHJcblx0XHR2YXIgYWxlcnQgPSBhbGVydCB8fCAkKCcuYWxlcnQnKTtcclxuXHJcblx0XHRhbGVydC5hbmltYXRlKHttYXJnaW5Ub3A6IDYwLCBvcGFjaXR5OiAwfSwgMTAwLCBmdW5jdGlvbigpe1xyXG5cdFx0XHRhbGVydC5oaWRlKCk7XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRzaG93OiBzaG93QWxlcnRcclxuXHR9XHJcbn0pKCk7IiwiJChmdW5jdGlvbiAoKSB7XHJcbiAgICBtaWdUYWJzLmluaXQoKTtcclxufSk7XHJcblxyXG4kKHdpbmRvdykucmVzaXplKGZ1bmN0aW9uICgpIHtcclxuICAgIG1pZ1RhYnMudGFic1Jlc2l6ZSgpO1xyXG59KTtcclxuXHJcbnZhciBtaWcgPSB7XHJcbiAgICBpbml0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbWlnLnRhYnNDb250YWluZXIgPSAkKCcubWlnLXRhYnMnKTtcclxuICAgICAgICBtaWcubWVudSA9ICQoJy5taWctdGFiLWxpbmsnKTtcclxuICAgICAgICBtaWcuZnJhbWVzQ29udGFpbmVyID0gJCgnLm1pZy1mcmFtZS1jb250ZW50Jyk7XHJcbiAgICAgICAgbWlnLmRhc2hib2FyZCA9IG1pZy5tZW51LmZpbHRlcignYVtuYW1lPVwiRGFzaGJvYXJkXCJdJyk7XHJcbiAgICAgICAgbWlnLnNldHVwKCk7ICAgICAgXHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzZXR1cDogZnVuY3Rpb24oKXtcclxuICAgICAgICBtaWcubWVudS5jbGljayhmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgdmFyIGN1cnJlbnRNZW51ID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgKGV2ZW50LnByZXZlbnREZWZhdWx0KSA/IGV2ZW50LnByZXZlbnREZWZhdWx0KCkgOiBldmVudC5yZXR1cm5WYWx1ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgdmFyIG5hbWUgPSAkKHRoaXMpLmF0dHIoJ25hbWUnKTtcclxuICAgICAgICAgICAgdmFyIGxpbmsgPSAkKHRoaXMpLmF0dHIoJ2hyZWYnKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50TWVudS5kYXRhKCd0YWInKSkge1xyXG4gICAgICAgICAgICAgICAgbWlnLnRhYlByZXNzKGN1cnJlbnRNZW51LmRhdGEoJ3RhYicpKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRNZW51LnRhYiA9IG1pZy50YWJDcmVhdGUobmFtZSwgbGluaywgY3VycmVudE1lbnUpO1xyXG4gICAgICAgICAgICAgICAgY3VycmVudE1lbnUuZGF0YSgndGFiJywgY3VycmVudE1lbnUudGFiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBtaWcuZGFzaGJvYXJkLnRyaWdnZXIoJ2NsaWNrJyk7XHJcblxyXG4gICAgICAgICQoJy5tYWluLWxvZ28nKS5jbGljayhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBtaWcuZGFzaGJvYXJkLnRyaWdnZXIoJ2NsaWNrJyk7IFxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICB0YWJDcmVhdGU6IGZ1bmN0aW9uIChuYW1lLCBsaW5rLCBtZW51KSB7XHJcblxyXG4gICAgICAgIHZhciB0YWIgPSAkKCc8bGkvPicsIHtcclxuICAgICAgICAgICAgbmFtZTogbmFtZVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2YXIgdGFiTGluayA9ICQoJzxhLz4nLCB7XHJcbiAgICAgICAgICAgIGhyZWY6IGxpbmssXHJcbiAgICAgICAgICAgIGFwcGVuZDogJCgnPHNwYW4vPicpLnRleHQobmFtZSksXHJcbiAgICAgICAgICAgIHRpdGxlOiBuYW1lLFxyXG4gICAgICAgICAgICBjbGljazogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgbWlnLnRhYlByZXNzKHRhYik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KS5hcHBlbmRUbyh0YWIpO1xyXG5cclxuICAgICAgICB2YXIgY2xvc2VCdG4gPSAkKCc8YnV0dG9uLz4nLCB7XHJcbiAgICAgICAgICAgIGNsYXNzOiAnbWlnLWNsb3NlLXRhYicsXHJcbiAgICAgICAgICAgIHR5cGU6ICdidXR0b24nLFxyXG4gICAgICAgICAgICBodG1sOiAnPGkgY2xhc3M9XCJpY29uLXRhYi1jbG9zZVwiPjwvaT4nLFxyXG4gICAgICAgICAgICBjbGljazogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgbWlnLnRhYkNsb3NlKHRhYik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KS5hcHBlbmRUbyh0YWIpO1xyXG5cclxuICAgICAgICB0YWIuY3NzKHsgdG9wOiAnNTBweCcgfSlcclxuICAgICAgICAgICAgLmFuaW1hdGUoeyB0b3A6IDAgfSwgMTAwKTtcclxuXHJcbiAgICAgICAgdmFyIHRhYkZyYW1lID0gbWlnLmZyYW1lQ3JlYXRlKG5hbWUsIGxpbmspO1xyXG4gICAgICAgIHRhYi5kYXRhKCdhY3RpdmUtZnJhbWUnLCB0YWJGcmFtZSk7XHJcbiAgICAgICAgdGFiLmZyYW1lcyA9IFtdO1xyXG4gICAgICAgIHRhYi5mcmFtZXMucHVzaCh0YWJGcmFtZSk7XHJcblxyXG4gICAgICAgIGlmICggbWVudSApe1xyXG4gICAgICAgICAgICB0YWIuYXBwZW5kVG8obWlnLnRhYnNDb250YWluZXIpO1xyXG4gICAgICAgICAgICB0YWIuZGF0YSgnbWVudScsIG1lbnUpO1xyXG4gICAgICAgICAgICBtaWcudGFiUHJlc3ModGFiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0YWIuaW5zZXJ0QWZ0ZXIobWlnLmN1cnJlbnRUYWIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRhYjtcclxuICAgIH0sXHJcblxyXG4gICAgdGFiUHJlc3M6IGZ1bmN0aW9uICh0YWIpIHtcclxuICAgICAgICBzZWxmID0gdGhpcztcclxuICAgICAgICBtaWcubWFrZUVsZW1lbnRBY3RpdmUodGFiKTtcclxuICAgICAgICBtaWcubWFrZU1lbnVBY3RpdmUodGFiLmRhdGEoJ21lbnUnKSk7XHJcbiAgICAgICAgbWlnLmN1cnJlbnRUYWIgPSB0YWI7XHJcbiAgICAgICAgbWlnLnRhYnNSZXNpemUoKTtcclxuICAgICAgICBtaWcuZnJhbWVTaG93KHRhYi5kYXRhKCdhY3RpdmUtZnJhbWUnKSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHRhYkNsb3NlOiBmdW5jdGlvbiAodGFiKSB7XHJcbiAgICAgICAgdmFyIHRhYnMgPSBtaWcudGFic0NvbnRhaW5lci5jaGlsZHJlbignbGknKTtcclxuXHJcbiAgICAgICAgaWYgKCh0YWIuaXMobWlnLmN1cnJlbnRUYWIpKSAmJiAodGFicy5sZW5ndGggPiAxKSkge1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0VGFiID0gKHRhYi5uZXh0KCkubGVuZ3RoID4gMCA/IHRhYi5uZXh0KCkgOiB0YWIucHJldigpKTtcclxuICAgICAgICAgICAgbWlnLnRhYlByZXNzKHRhcmdldFRhYik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0YWIuZGF0YSgnbWVudScpICYmIHRhYi5kYXRhKCdtZW51JykucmVtb3ZlRGF0YSgndGFiJyk7XHJcbiAgICAgICAgbWlnLnJlbW92ZUVsZW1lbnRBcnJheSh0YWIuZnJhbWVzKTtcclxuICAgICAgICB0YWIucmVtb3ZlKCk7XHJcbiAgICAgICAgbWlnLnRhYnNSZXNpemUoKTtcclxuXHJcbiAgICAgICAgdGFicy5sZW5ndGggPT0gMSAmJiBtaWcuZGFzaGJvYXJkLnRyaWdnZXIoJ2NsaWNrJyk7XHJcbiAgICB9LFxyXG5cclxuICAgIHRhYlNldEFjdGl2ZUZyYW1lOiBmdW5jdGlvbiAoZnJhbWUpIHtcclxuICAgICAgICBtaWcuY3VycmVudFRhYi5kYXRhKCdhY3RpdmUtZnJhbWUnLCBmcmFtZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHRhYkFkZEZyYW1lOiBmdW5jdGlvbiAoZnJhbWUpIHtcclxuICAgICAgICBtaWcuY3VycmVudFRhYi5mcmFtZXMucHVzaChmcmFtZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHRhYnNSZXNpemU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdGFic05vdEFjdGl2ZSA9IG1pZy50YWJzQ29udGFpbmVyLmZpbmQoJ2xpJykubm90KCcuYWN0aXZlJyk7XHJcbiAgICAgICAgdmFyIHRhYnMgPSBtaWcudGFic0NvbnRhaW5lci5maW5kKCdsaScpO1xyXG4gICAgICAgIHZhciBBQ1RJVkVfVEFCX1dJRFRIID0gMTYwO1xyXG4gICAgICAgIHZhciB0YWJzQ29udGFpbmVyV2lkdGggPSBtaWcudGFic0NvbnRhaW5lci53aWR0aCgpIC0gQUNUSVZFX1RBQl9XSURUSDtcclxuICAgICAgICB0YWJzLm91dGVyV2lkdGgodGFic0NvbnRhaW5lcldpZHRoIC8gdGFic05vdEFjdGl2ZS5sZW5ndGgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBmcmFtZUNyZWF0ZTogZnVuY3Rpb24gKG5hbWUsIGxpbmssIHBhcmVudCkge1xyXG4gICAgICAgIHZhciBmcmFtZSA9ICQoJzxpZnJhbWUvPicsIHtcclxuICAgICAgICAgICAgc3JjOiBsaW5rLFxyXG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIH0pLmFwcGVuZFRvKG1pZy5mcmFtZXNDb250YWluZXIpO1xyXG5cclxuICAgICAgICBmcmFtZS5saW5rID0gbGluaztcclxuICAgICAgICBmcmFtZS5uYW1lID0gbmFtZTtcclxuXHJcbiAgICAgICAgaWYgKHBhcmVudCkge1xyXG4gICAgICAgICAgICBmcmFtZS5wYXJlbnRGcmFtZSA9IHBhcmVudDtcclxuICAgICAgICAgICAgcGFyZW50LmNoaWxkRnJhbWUgPSBmcmFtZTtcclxuICAgICAgICAgICAgbWlnLm1ha2VFbGVtZW50QWN0aXZlKGZyYW1lKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG1pZy5mcmFtZUluaXRDb250ZW50KGZyYW1lKTtcclxuICAgICAgICBtaWcuY3VycmVudEZyYW1lID0gZnJhbWU7XHJcblxyXG5cclxuICAgICAgICByZXR1cm4gZnJhbWU7XHJcbiAgICB9LFxyXG5cclxuICAgIGZyYW1lSW5pdENvbnRlbnQ6IGZ1bmN0aW9uIChmcmFtZSkge1xyXG4gICAgICAgIGZyYW1lLmxvYWQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBtaWcuaW5zZXRzQ29udGFpbmVyID0gZnJhbWUuY29udGVudHMoKS5maW5kKCcubWlnLWJyZWFkY3J1bWJzJyk7XHJcbiAgICAgICAgICAgIGZyYW1lLnBhcmVudEZyYW1lcyA9IFtdO1xyXG4gICAgICAgICAgICBmcmFtZS5jaGlsZEZyYW1lcyA9IFtdO1xyXG4gICAgICAgICAgICBtaWcuaW5pdGlhbEZyYW1lID0gZnJhbWU7XHJcbiAgICAgICAgICAgIG1pZy5mcmFtZVNldFBhcmVudEFycmF5KGZyYW1lKTtcclxuICAgICAgICAgICAgbWlnLmZyYW1lSW5pdEluc2V0cyhmcmFtZSk7XHJcbiAgICAgICAgICAgIG1pZy5pbnNldEJ1dHRvbkluaXQoZnJhbWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBpbnNldEJ1dHRvbkluaXQ6IGZ1bmN0aW9uIChmcmFtZSkge1xyXG4gICAgICAgIGlmIChmcmFtZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHZhciBpbnNldEJ1dHRvbiA9IGZyYW1lLmNvbnRlbnRzKCkuZmluZCgnLm1pZy1pbnNldC1idG4nKTtcclxuICAgICAgICAgICAgdmFyIGJvZHkgPSBmcmFtZS5jb250ZW50cygpLmZpbmQoJ2JvZHknKTtcclxuXHJcbiAgICAgICAgICAgIGJvZHkub24oJ2NsaWNrJywgJy5taWctaW5zZXQtYnRuJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5hdHRyKCd0YXJnZXQnKSA9PSAnX2JsYW5rJyApXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIChldmVudC5wcmV2ZW50RGVmYXVsdCkgPyBldmVudC5wcmV2ZW50RGVmYXVsdCgpIDogZXZlbnQucmV0dXJuVmFsdWUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudEluc2V0QnV0dG9uID0gKCQoZXZlbnQudGFyZ2V0KS5oYXNDbGFzcygnLm1pZy1pbnNldC1idG4nKSA/ICQoZXZlbnQudGFyZ2V0KSA6ICQoZXZlbnQudGFyZ2V0KS5jbG9zZXN0KCcubWlnLWluc2V0LWJ0bicpKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaW5zZXROYW1lID0gY3VycmVudEluc2V0QnV0dG9uLmF0dHIoJ25hbWUnKTtcclxuICAgICAgICAgICAgICAgIHZhciBpbnNldExpbmsgPSBjdXJyZW50SW5zZXRCdXR0b24uYXR0cignaHJlZicpIHx8IGN1cnJlbnRJbnNldEJ1dHRvbi5kYXRhKCdocmVmJyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlRnJhbWUgPSBtaWcuY3VycmVudFRhYi5kYXRhKCdhY3RpdmUtZnJhbWUnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQuY3RybEtleSl7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYiA9IG1pZy50YWJDcmVhdGUoaW5zZXROYW1lLCBpbnNldExpbmspO1xyXG4gICAgICAgICAgICAgICAgICAgIHRhYi5zb3VyY2VGcmFtZSA9IHNvdXJjZUZyYW1lO1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldEZyYW1lID0gbWlnLmZyYW1lQ3JlYXRlKGluc2V0TmFtZSwgaW5zZXRMaW5rLCBzb3VyY2VGcmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbWlnLnRhYlNldEFjdGl2ZUZyYW1lKHRhcmdldEZyYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICBtaWcudGFiQWRkRnJhbWUodGFyZ2V0RnJhbWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgZnJhbWVTaG93OiBmdW5jdGlvbiAoZnJhbWUpIHtcclxuICAgICAgICBtaWcubWFrZUVsZW1lbnRBY3RpdmUoZnJhbWUpO1xyXG4gICAgICAgIG1pZy5jdXJyZW50RnJhbWUgPSBmcmFtZTtcclxuICAgIH0sXHJcblxyXG4gICAgZnJhbWVJbml0SW5zZXRzOiBmdW5jdGlvbiAoZnJhbWUpIHtcclxuICAgICAgICB2YXIgaHRtbCA9ICcnO1xyXG4gICAgICAgIHZhciBpbnNldHMgPSBmcmFtZS5wYXJlbnRGcmFtZXMucmV2ZXJzZSgpO1xyXG4gICAgICAgIGluc2V0cy5wdXNoKGZyYW1lKTtcclxuXHJcbiAgICAgICAgalF1ZXJ5LmVhY2goaW5zZXRzLCBmdW5jdGlvbiAoaSwgaW5zZXRGcmFtZSkge1xyXG4gICAgICAgICAgICB2YXIgaW5zZXQgPSAkKCc8YS8+Jywge1xyXG4gICAgICAgICAgICAgICAgc3JjOiBpbnNldEZyYW1lLmxpbmssXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBpbnNldEZyYW1lLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBhcHBlbmQ6IGluc2V0RnJhbWUubmFtZSxcclxuICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9taWcuZnJhbWVSZWxvYWQoaW5zZXRGcmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbWlnLmZyYW1lU2hvdyhpbnNldEZyYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICBtaWcudGFiU2V0QWN0aXZlRnJhbWUoaW5zZXRGcmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbWlnLmZyYW1lU2V0Q2hpbGRBcnJheShpbnNldEZyYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICBtaWcucmVtb3ZlRWxlbWVudEFycmF5KG1pZy5jdXJyZW50RnJhbWUuY2hpbGRGcmFtZXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgJCgnPGxpPjwvbGk+JykuYXBwZW5kKGluc2V0KS5hcHBlbmRUbyhtaWcuaW5zZXRzQ29udGFpbmVyKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIGZyYW1lUmVsb2FkOiBmdW5jdGlvbiAoZnJhbWUpIHtcclxuICAgICAgICBmcmFtZS5hdHRyKCdzcmMnLCBmcmFtZS5saW5rKTtcclxuICAgIH0sXHJcblxyXG4gICAgZnJhbWVSZWxvYWRXaXRoTmV3VXJsOiBmdW5jdGlvbiAoZnJhbWUsIHVybCwgdGltZSkge1xyXG4gICAgICAgIHZhciB0aW1lID0gKHRpbWUgPyB0aW1lIDogMCk7XHJcbiAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgZnJhbWUuYXR0cignc3JjJywgdXJsKTtcclxuICAgICAgICB9ICwgdGltZSk7XHJcbiAgICAgICAgXHJcbiAgICB9LFxyXG5cclxuICAgIGZyYW1lU2V0UGFyZW50QXJyYXk6IGZ1bmN0aW9uIChmcmFtZSkge1xyXG4gICAgICAgIGlmIChmcmFtZS5wYXJlbnRGcmFtZSkge1xyXG4gICAgICAgICAgICBtaWcuaW5pdGlhbEZyYW1lLnBhcmVudEZyYW1lcy5wdXNoKGZyYW1lLnBhcmVudEZyYW1lKTtcclxuICAgICAgICAgICAgbWlnLmZyYW1lU2V0UGFyZW50QXJyYXkoZnJhbWUucGFyZW50RnJhbWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGZyYW1lU2V0Q2hpbGRBcnJheTogZnVuY3Rpb24gKGZyYW1lKSB7XHJcblxyXG4gICAgICAgIGlmIChmcmFtZS5jaGlsZEZyYW1lKSB7XHJcbiAgICAgICAgICAgIG1pZy5jdXJyZW50RnJhbWUuY2hpbGRGcmFtZXMucHVzaChmcmFtZS5jaGlsZEZyYW1lKTtcclxuICAgICAgICAgICAgbWlnLmZyYW1lU2V0Q2hpbGRBcnJheShmcmFtZS5jaGlsZEZyYW1lKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBpbnNldENsb3NlOiBmdW5jdGlvbihmcmFtZSkge1xyXG4gICAgICAgICAgICBmcmFtZS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgbWlnLnRhYlNldEFjdGl2ZUZyYW1lKGZyYW1lLnBhcmVudEZyYW1lKTtcclxuICAgICAgICAgICAgbWlnLmZyYW1lUmVsb2FkKGZyYW1lLnBhcmVudEZyYW1lKTtcclxuICAgICAgICAgICAgbWlnLmZyYW1lU2hvdyhmcmFtZS5wYXJlbnRGcmFtZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHBhZ2VDbG9zZTogZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgZnJhbWUgPSBtaWcuY3VycmVudEZyYW1lO1xyXG4gICAgICAgIHZhciB0YWIgPSBtaWcuY3VycmVudFRhYjtcclxuICAgICAgICBmcmFtZS5wYXJlbnRGcmFtZSA/IG1pZy5pbnNldENsb3NlKGZyYW1lKSA6IG1pZy50YWJDbG9zZSh0YWIpO1xyXG4gICAgfSxcclxuXHJcbiAgICBtYWtlTWVudUFjdGl2ZTogZnVuY3Rpb24gKG1lbnUpe1xyXG4gICAgICAgIG1pZy5tZW51LnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICBpZiAobWVudSAmJiAhbWVudS5pcyhtaWcuZGFzaGJvYXJkKSl7XHJcbiAgICAgICAgICAgIG1lbnUuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIG1ha2VFbGVtZW50QWN0aXZlOiBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIGVsZW1lbnQuc2libGluZ3MoKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlbW92ZUVsZW1lbnRBcnJheTogZnVuY3Rpb24gKGVsZW1lbnRzKSB7XHJcbiAgICAgICAgalF1ZXJ5LmVhY2goZWxlbWVudHMsIGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkge1xyXG4gICAgICAgICAgICBlbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICByZWxvYWRDdXJyZW50RnJhbWU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBtaWcuZnJhbWVSZWxvYWQobWlnLmN1cnJlbnRGcmFtZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlbG9hZEN1cnJlbnRGcmFtZVdpdGhOZXdVcmw6IGZ1bmN0aW9uICh1cmwsIHRpbWUpIHtcclxuICAgICAgICBcclxuICAgICAgICBtaWcuZnJhbWVSZWxvYWRXaXRoTmV3VXJsKG1pZy5jdXJyZW50RnJhbWUsIHVybCwgdGltZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlbG9hZFNvdXJjZUZyYW1lV2l0aE5ld1VybDogZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgIG1pZy5jdXJyZW50VGFiLnNvdXJjZUZyYW1lID8gbWlnLmZyYW1lUmVsb2FkKG1pZy5jdXJyZW50VGFiLnNvdXJjZUZyYW1lKSA6IG1pZy5wYXJlbnRGcmFtZXNSZWxvYWRXaXRoTmV3VXJsKG1pZy5jdXJyZW50RnJhbWUsIHVybCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlbG9hZFNvdXJjZUZyYW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBtaWcuY3VycmVudFRhYi5zb3VyY2VGcmFtZSA/IG1pZy5mcmFtZVJlbG9hZChtaWcuY3VycmVudFRhYi5zb3VyY2VGcmFtZSkgOiBtaWcucGFyZW50RnJhbWVzUmVsb2FkKG1pZy5jdXJyZW50RnJhbWUpO1xyXG4gICAgfSxcclxuXHJcbiAgICBwYXJlbnRGcmFtZXNSZWxvYWQ6IGZ1bmN0aW9uKGZyYW1lKXtcclxuICAgICAgICBpZiAoZnJhbWUucGFyZW50RnJhbWUpe1xyXG4gICAgICAgICAgICBtaWcuZnJhbWVSZWxvYWQoZnJhbWUucGFyZW50RnJhbWUpO1xyXG4gICAgICAgICAgICBtaWcucGFyZW50RnJhbWVzUmVsb2FkKGZyYW1lLnBhcmVudEZyYW1lKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHBhcmVudEZyYW1lc1JlbG9hZFdpdGhOZXdVcmw6IGZ1bmN0aW9uKGZyYW1lLCB1cmwpe1xyXG4gICAgICAgIGlmIChmcmFtZS5wYXJlbnRGcmFtZSl7XHJcbiAgICAgICAgICAgIG1pZy5mcmFtZVJlbG9hZFdpdGhOZXdVcmwoZnJhbWUucGFyZW50RnJhbWUsIHVybCk7XHJcbiAgICAgICAgICAgIG1pZy5wYXJlbnRGcmFtZXNSZWxvYWRXaXRoTmV3VXJsKGZyYW1lLnBhcmVudEZyYW1lKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcblxyXG52YXIgbWlnVGFicyA9IE9iamVjdC5jcmVhdGUobWlnKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG4vLyAkKHdpbmRvdykub24oXCJuYXZpZ2F0ZVwiLCBmdW5jdGlvbiAoZXZlbnQsIGRhdGEpIHtcclxuLy8gICAgIHZhciBkaXJlY3Rpb24gPSBkYXRhLnN0YXRlLmRpcmVjdGlvbjtcclxuLy8gICAgIGlmIChkaXJlY3Rpb24gPT0gJ2JhY2snKSB7XHJcbi8vICAgICAgICAgYWxlcnQoJ2EnKTtcclxuLy8gICAgICAgICB3aW5kb3cubWlnVGFicy5pbnNldENsb3NlKCk7XHJcbi8vICAgICAgICAgd2luZG93Lmhpc3RvcnkuZm9yd2FyZCgxKTtcclxuLy8gICAgIH1cclxuXHJcbi8vICAgICBpZiAoZGlyZWN0aW9uID09ICdmb3J3YXJkJykge1xyXG4vLyAgICAgICAgLy93aW5kb3cuaGlzdG9yeS5iYWNrKCk7IFxyXG4vLyAgICAgfVxyXG4vLyB9KTtcclxuXHJcbiIsInZhciBjbGlwYm9hcmRNb2R1bGUgPSAoZnVuY3Rpb24oKXtcclxuXHJcblx0JChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5zaG93LWNsaXBib2FyZC1idG4nLCBmdW5jdGlvbigpe1xyXG5cclxuXHRcdCQoJy5taWctY2xpcGJvYXJkJykuaGFzQ2xhc3MoJ3Zpc2libGUnKVxyXG5cdFx0PyBoaWRlQ2xpcGJvYXJkKClcclxuXHRcdDogc2hvd0NsaXBib2FyZCgpO1xyXG5cclxuXHR9KTtcclxuXHJcblx0ZnVuY3Rpb24gc2hvd0NsaXBib2FyZCgpe1xyXG5cdFx0dmFyIGNsaXBib2FyZCA9ICQoJy5taWctY2xpcGJvYXJkJyksXHJcblx0XHRcdGNsaXBib2FyZEJ0biA9IGNsaXBib2FyZC5maW5kKCcuc2hvdy1jbGlwYm9hcmQtYnRuJyk7XHJcblxyXG5cdFx0Y2xpcGJvYXJkQnRuLmZpbmQoJ2knKS5yZW1vdmVDbGFzcygnaWNvbi1hbmdsZS11cCcpLmFkZENsYXNzKCdpY29uLWFuZ2xlLWRvd24nKTtcclxuXHRcdGNsaXBib2FyZC5hZGRDbGFzcygndmlzaWJsZScpO1xyXG5cdFx0JCgnLm1pZy1mcmFtZS1jb250ZW50JykuYW5pbWF0ZSh7cGFkZGluZ0JvdHRvbTogY2xpcGJvYXJkLmhlaWdodCgpfSwgMjAwKTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGhpZGVDbGlwYm9hcmQoKXtcclxuXHRcdHZhciBjbGlwYm9hcmQgPSAkKCcubWlnLWNsaXBib2FyZCcpLFxyXG5cdFx0XHRjbGlwYm9hcmRCdG4gPSBjbGlwYm9hcmQuZmluZCgnLnNob3ctY2xpcGJvYXJkLWJ0bicpO1xyXG5cclxuXHRcdGNsaXBib2FyZEJ0bi5maW5kKCdpJykucmVtb3ZlQ2xhc3MoJ2ljb24tYW5nbGUtZG93bicpLmFkZENsYXNzKCdpY29uLWFuZ2xlLXVwJyk7XHJcblx0XHRjbGlwYm9hcmQucmVtb3ZlQ2xhc3MoJ3Zpc2libGUnKTtcclxuXHRcdCQoJy5taWctZnJhbWUtY29udGVudCcpLmFuaW1hdGUoe3BhZGRpbmdCb3R0b206IDB9LCAyMDApO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gc2V0Q2xpcGJvYXJkTGVuZ3RoKCl7XHJcblx0XHR2YXIgY2xpcGJvYXJkID0gJCgnLm1pZy1jbGlwYm9hcmQnKSxcclxuXHRcdFx0Y2xpcGJvYXJkQnRuID0gY2xpcGJvYXJkLmZpbmQoJy5zaG93LWNsaXBib2FyZC1idG4nKTtcclxuXHJcblx0XHRjbGlwYm9hcmRCdG4uZmluZCgnLmNvdW50ZXInKS50ZXh0KCcoJyArIGNsaXBib2FyZC5maW5kKCcuY2xpcGJvYXJkLWFzc2V0JykubGVuZ3RoICsnKScpO1xyXG5cclxuXHRcdGlmIChjbGlwYm9hcmQuZmluZCgnLmNsaXBib2FyZC1hc3NldCcpLmxlbmd0aCA9PSAwKXtcclxuXHRcdFx0aGlkZUNsaXBib2FyZCgpO1xyXG5cdFx0fVxyXG5cclxuXHR9XHJcblxyXG5cdHJldHVybntcclxuXHRcdHNob3c6IHNob3dDbGlwYm9hcmQsXHJcblx0XHRoaWRlOiBoaWRlQ2xpcGJvYXJkLFxyXG5cdFx0c2V0TGVuZ3RoOiBzZXRDbGlwYm9hcmRMZW5ndGhcclxuXHR9XHJcbn0pKCk7XHJcblxyXG5cclxuXHJcbnZhciBtaWdBc3NldCA9IHtcclxuXHRjbGlwYm9hcmRBc3NldEFycmF5OiBbXSxcclxuXHJcblx0dHJpZ2dlckFzc2V0OiBmdW5jdGlvbihpZCl7XHJcblx0XHR2YXIgc2VsZiA9IHRoaXMsXHJcblx0XHRcdGVsZW1lbnQgPSBtaWdUYWJzLmN1cnJlbnRGcmFtZS5jb250ZW50cygpLmZpbmQoJy5hc3NldC1saXN0ID4gLmFzc2V0W2RhdGEtaWQ9JytpZCsnXScpO1xyXG5cclxuXHRcdHNlbGYuY3JlYXRlQXNzZXQoZWxlbWVudCk7XHJcblx0fSxcclxuXHJcblx0Y3JlYXRlQXNzZXQ6IGZ1bmN0aW9uKGVsZW1lbnQpe1xyXG5cdFx0dmFyIHNlbGYgPSB0aGlzLFxyXG5cdFx0XHRhc3NldENvbnRhaW5lciA9ICQoZWxlbWVudCkuaXMoJy5hc3NldCcpID8gJChlbGVtZW50KSA6ICQoZWxlbWVudCkuY2xvc2VzdCgnLmFzc2V0Jyk7XHJcblx0XHRcclxuXHJcblx0XHRpZiAoc2VsZi5pbkNsaXBib2FyZChhc3NldENvbnRhaW5lci5kYXRhKCdpZCcpKSA+PSAwKXtcclxuXHRcdFx0Y2xpcGJvYXJkTW9kdWxlLnNob3coKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0XHR2YXIgYXNzZXQgPSB7XHJcblx0XHRcdHR5cGU6IGFzc2V0Q29udGFpbmVyLmRhdGEoJ3R5cGUnKSxcclxuXHRcdFx0aWQ6IGFzc2V0Q29udGFpbmVyLmRhdGEoJ2lkJyksXHJcblx0XHRcdGltYWdlOiBhc3NldENvbnRhaW5lci5maW5kKCcuYXNzZXQtaW1hZ2UnKS5hdHRyKCdzcmMnKSxcclxuXHRcdFx0bmFtZTogYXNzZXRDb250YWluZXIuZmluZCgnLmFzc2V0LW5hbWUnKS50ZXh0KCksXHJcblx0XHRcdHNpemU6IGFzc2V0Q29udGFpbmVyLmZpbmQoJy5hc3NldC1zaXplJykudGV4dCgpLFxyXG5cdFx0XHRkYXRlOiBhc3NldENvbnRhaW5lci5maW5kKCcuYXNzZXQtZGF0ZScpLnRleHQoKSxcclxuXHRcdFx0Zm9ybWF0OiBhc3NldENvbnRhaW5lci5maW5kKCcuYXNzZXQtZm9ybWF0JykudGV4dCgpLFxyXG5cdFx0fVxyXG5cclxuXHRcdHNlbGYuaW5DbGlwYm9hcmQoYXNzZXQuaWQpO1xyXG5cclxuXHRcdGFzc2V0Q29udGFpbmVyLmRhdGEoJ2Fzc2V0JywgYXNzZXQpO1xyXG5cdFx0c2VsZi5hZGRUb0NsaXBib2FyZChhc3NldCk7XHJcblx0fSxcclxuXHJcblx0YWRkVG9DbGlwYm9hcmQ6IGZ1bmN0aW9uKGFzc2V0KXtcclxuXHRcdHZhciBzZWxmID0gdGhpcyxcclxuXHRcdFx0Y2xpcGJvYXJkQXNzZXRMaXN0ID0gJCgnLmNsaXBib2FyZC1hc3NldC1saXN0JyksXHJcblx0XHRcdGNsaXBib2FyZEFzc2V0Q29udGFpbmVyID0gJCgnPGxpIGNsYXNzPVwiY2xpcGJvYXJkLWFzc2V0XCIgZGF0YS10eXBlPVwiJysgYXNzZXQudHlwZSArJ1wiPjxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnV0dG9uIHJlbW92ZS1hc3NldC1idG5cIj48aSBjbGFzcz1cImljb24tY2xvc2VcIj48L2k+PC9idXR0b24+PGZpZ3VyZSBjbGFzcz1cImFzc2V0LXZpZXdcIj48aW1nIGNsYXNzPVwiYXNzZXQtaW1hZ2VcIiBzcmM9XCJcIiBhbHQ9XCJcIj48L2ZpZ3VyZT48ZGl2IGNsYXNzPVwiYXNzZXQtZGV0YWlsc1wiPjxwIGNsYXNzPVwiYXNzZXQtbmFtZVwiPjwvcD48cCBjbGFzcz1cImFzc2V0LXNpemVcIj48L3A+PHAgY2xhc3M9XCJhc3NldC1kYXRlXCI+PC9wPjwvZGl2PjwvbGk+Jyk7XHJcblxyXG5cdFx0Y2xpcGJvYXJkQXNzZXRDb250YWluZXIuZmluZCgnLmFzc2V0LWltYWdlJykuYXR0cignc3JjJywgYXNzZXQuaW1hZ2UpO1xyXG5cdFx0Y2xpcGJvYXJkQXNzZXRDb250YWluZXIuZmluZCgnLmFzc2V0LW5hbWUnKS50ZXh0KGFzc2V0Lm5hbWUpO1xyXG5cdFx0Y2xpcGJvYXJkQXNzZXRDb250YWluZXIuZmluZCgnLmFzc2V0LXNpemUnKS50ZXh0KGFzc2V0LnNpemUpO1xyXG5cdFx0Y2xpcGJvYXJkQXNzZXRDb250YWluZXIuZmluZCgnLmFzc2V0LWRhdGUnKS50ZXh0KGFzc2V0LmRhdGUpO1xyXG5cdFx0Y2xpcGJvYXJkQXNzZXRDb250YWluZXIuZmluZCgnLnJlbW92ZS1hc3NldC1idG4nKS5jbGljayhmdW5jdGlvbigpe1xyXG5cdFx0XHRzZWxmLnJlbW92ZUZyb21DbGlwYm9hcmQoYXNzZXQpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0aWYgKGFzc2V0LnR5cGUgPT0gJ2ZpbGUnIHx8IGFzc2V0LnR5cGUgPT0gJ3ZpZGVvJyl7XHJcblx0XHRcdGNsaXBib2FyZEFzc2V0Q29udGFpbmVyLmZpbmQoJy5hc3NldC12aWV3JylcclxuXHRcdFx0XHQuYXBwZW5kKCc8c3BhbiBjbGFzcz1cImFzc2V0LWZvcm1hdFwiPicgKyBhc3NldC5mb3JtYXQgKyAnPC9zcGFuPicpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChhc3NldC50eXBlID09ICd0ZW1wbGF0ZScpe1xyXG5cdFx0XHRjbGlwYm9hcmRBc3NldENvbnRhaW5lci5maW5kKCcuYXNzZXQtbmFtZScpXHJcblx0XHRcdFx0Lmh0bWwoJ1RlbXBsYXRlIDwvYnI+IycgKyBhc3NldC5pZCk7XHJcblx0XHR9XHJcblxyXG5cdFx0YXNzZXQuY2xpcGJvYXJkQ29udGFpbmVyID0gY2xpcGJvYXJkQXNzZXRDb250YWluZXI7XHJcblx0XHRjbGlwYm9hcmRBc3NldENvbnRhaW5lci5kYXRhKCdhc3NldCcsIGFzc2V0KTtcclxuXHJcblx0XHRjbGlwYm9hcmRBc3NldExpc3QuYXBwZW5kKGNsaXBib2FyZEFzc2V0Q29udGFpbmVyKTtcclxuXHRcdHNlbGYuY2xpcGJvYXJkQXNzZXRBcnJheS5wdXNoKGFzc2V0LmlkKTtcclxuXHJcblx0XHRcdFxyXG5cdFx0Y2xpcGJvYXJkTW9kdWxlLnNob3coKTtcclxuXHRcdGNsaXBib2FyZE1vZHVsZS5zZXRMZW5ndGgoKTtcclxuXHJcblx0XHRzZWxmLmluaXRBc3NldERyYWcoYXNzZXQpO1xyXG5cdH0sXHJcblxyXG5cdHJlbW92ZUZyb21DbGlwYm9hcmQ6IGZ1bmN0aW9uKGFzc2V0KXtcclxuXHRcdHZhciBzZWxmID0gdGhpc1xyXG5cdFx0YXNzZXQuY2xpcGJvYXJkQ29udGFpbmVyLnJlbW92ZSgpO1xyXG5cdFx0Y2xpcGJvYXJkTW9kdWxlLnNldExlbmd0aCgpO1xyXG5cdFx0c2VsZi5jbGlwYm9hcmRBc3NldEFycmF5LnNwbGljZSggJC5pbkFycmF5KGFzc2V0LmlkLCBzZWxmLmNsaXBib2FyZEFzc2V0QXJyYXkpLCAxICk7XHJcblx0XHRkZWxldGUgYXNzZXQ7XHJcblx0fSxcclxuXHJcblx0aW5pdEFzc2V0RHJhZzogZnVuY3Rpb24oYXNzZXQpe1xyXG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuXHRcdGFzc2V0LmNsaXBib2FyZENvbnRhaW5lci5kcmFnZ2FibGUoe1xyXG5cdFx0XHRhZGRDbGFzc2VzOiBmYWxzZSxcclxuXHRcdFx0YXBwZW5kVG86ICdib2R5JyxcclxuXHRcdFx0cmV2ZXJ0OiBcImludmFsaWRcIixcclxuXHRcdFx0Y3Vyc29yQXQ6IHsgdG9wOiAxLCBsZWZ0OiAxIH0sXHJcblx0XHRcdGN1cnNvcjogXCJtb3ZlXCIsXHJcblx0XHRcdGlmcmFtZUZpeDogdHJ1ZSxcclxuXHRcdFx0aWZyYW1lT2Zmc2V0OiBtaWdUYWJzLmN1cnJlbnRGcmFtZS5vZmZzZXQoKSxcclxuXHJcblx0XHRcdGhlbHBlcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0cmV0dXJuICQoJzxkaXYgY2xhc3M9XCJkcmFnZ2FibGUtYXNzZXRcIiBkYXRhLXR5cGU9XCInK2Fzc2V0LnR5cGUrJ1wiPjwvZGl2PicpLmFwcGVuZCggJzxkaXY+JyArICQodGhpcykuaHRtbCgpICsgJzwvZGl2PicpO1xyXG5cdFx0XHR9LFxyXG5cclxuXHRcdFx0c3RhcnQ6IGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0c2VsZi5pbml0RHJvcHBlcnMoYXNzZXQpO1xyXG5cdFx0XHRcdCQoJ2JvZHknKS5jc3Moe292ZXJmbG93OiAnaGlkZGVuJ30pO1xyXG5cdFx0XHRcdCQodGhpcykuY3NzKHtvcGFjaXR5OiAuNX0pO1xyXG5cdFx0XHR9LFxyXG5cclxuXHRcdFx0c3RvcDogZnVuY3Rpb24oKXtcclxuXHRcdFx0XHQkKCdib2R5JykuY3NzKHtvdmVyZmxvdzogJyd9KTtcclxuXHRcdFx0XHQkKHRoaXMpLmNzcyh7b3BhY2l0eTogMX0pO1xyXG5cclxuXHRcdFx0fSxcclxuXHJcblx0XHRcdGNhbmNlbDogZnVuY3Rpb24oKXtcclxuXHRcdFx0XHQkKHRoaXMpLmNzcyh7b3BhY2l0eTogMX0pO1xyXG5cdFx0XHR9LFxyXG5cclxuXHRcdH0pO1xyXG5cdH0sXHJcblxyXG5cdGluaXREcm9wcGVyczogZnVuY3Rpb24oYXNzZXQpe1xyXG5cdFx0dmFyIHNlbGYgPSB0aGlzLFxyXG5cdFx0XHRkcm9wcGVycyA9IG1pZ1RhYnMuY3VycmVudEZyYW1lLmNvbnRlbnRzKCkuZmluZCgnLmRyb3BwZXJbZGF0YS10eXBlPVwiJyArIGFzc2V0LnR5cGUgKyAnXCJdLCAuZHJvcHBlcltkYXRhLXR5cGU9XCJmaWxlXCJdJyk7XHJcblx0XHRcclxuXHRcdC8vZm9yIG1jZSBFZGl0b3JcclxuXHRcdGlmIChhc3NldC50eXBlID09ICdpbWFnZScpXHJcblx0XHRcdHZhciBkcm9wcGVycyA9IGRyb3BwZXJzLmFkZChtaWdUYWJzLmN1cnJlbnRGcmFtZS5jb250ZW50cygpLmZpbmQoJy5tY2Utd2luZG93W2FyaWEtbGFiZWw9XCJJbnNlcnQvZWRpdCBpbWFnZVwiXSAubWNlLWZpcnN0Lm1jZS1mb3JtaXRlbSAubWNlLXRleHRib3gnKSk7IFxyXG5cclxuXHRcdGlmIChhc3NldClcclxuXHRcdGRyb3BwZXJzLmRyb3BwYWJsZSh7ZGlzYWJsZWQ6IGZhbHNlfSk7XHJcblxyXG5cclxuXHRcdGRyb3BwZXJzLmRyb3BwYWJsZSh7XHJcblx0XHRcdGFkZENsYXNzZXM6IGZhbHNlLFxyXG5cdFx0XHRhY3RpdmVDbGFzczogXCJhY3RpdmVcIixcclxuXHRcdFx0aG92ZXJDbGFzczogXCJob3ZlclwiLFxyXG5cdFx0XHRpZnJhbWVGaXg6IHRydWUsXHJcbiAgICAgICAgICAgIGlmcmFtZU9mZnNldDogbWlnVGFicy5jdXJyZW50RnJhbWUub2Zmc2V0KCksXHJcbiAgICAgICAgICAgIGRyb3A6IGZ1bmN0aW9uKCl7XHJcblx0ICAgICAgICAgICAgdmFyIGRyb3BwZXIgPSAkKHRoaXMpO1xyXG5cclxuXHQgICAgICAgICAgICAoZHJvcHBlci5pcygnaW5wdXQnKSlcclxuXHRcdCAgICAgICAgICAgID8gbWlnVGFicy5jdXJyZW50RnJhbWVbMF0uY29udGVudFdpbmRvdy5tY2V1SW1hZ2VNb2R1bGUuZHJvcEFzc2V0SW5JbnB1dChkcm9wcGVyLCBhc3NldClcclxuXHRcdCAgICAgICAgICAgIDogbWlnVGFicy5jdXJyZW50RnJhbWVbMF0uY29udGVudFdpbmRvdy4kKHRoaXMpLnRyaWdnZXIoJ2Ryb3AnLCBhc3NldCk7XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBkZWFjdGl2YXRlOiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5kcm9wcGFibGUoe2Rpc2FibGVkOiB0cnVlfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblxyXG5cdGluQ2xpcGJvYXJkOiBmdW5jdGlvbihpZCl7XHJcblx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblx0XHRyZXR1cm4gJC5pbkFycmF5KGlkLCBzZWxmLmNsaXBib2FyZEFzc2V0QXJyYXkpO1xyXG5cdH1cclxufVxyXG4iLCJ2YXIgc2lkZWJhck1lbnVDb250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XHJcblx0dmFyIHNpZGViYXIgPSAkKCcuc2lkZWJhcicpLFxyXG5cdFx0bWFpbk1lbnUgPSAkKCcuc2lkZWJhcicpLmZpbmQoJy5tYWluLW1lbnUnKSxcclxuXHRcdG1haW5NZW51TGlua3MgPSBtYWluTWVudS5maW5kKCcubWVudS1wcmltYXJ5LWxpbmsnKSxcclxuXHRcdHN1Yk1lbnUgPSBtYWluTWVudS5maW5kKCcuc3ViLW1lbnUnKTtcclxuXHJcblx0JChkb2N1bWVudCkub24oJ21vdXNlZW50ZXInLCAnLnNpZGViYXIgLm1haW4tbWVudSAubWVudS1wcmltYXJ5LWxpbmssIC5zaWRlYmFyIC5tYWluLW1lbnUgLnN1Yi1tZW51JywgZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHR0b1RvcCh0aGlzKTtcclxuXHR9KTtcclxuXHJcblx0JChkb2N1bWVudCkub24oJ21vdXNlbGVhdmUnLCAnLnNpZGViYXIgLm1haW4tbWVudSAubWVudS1wcmltYXJ5LWxpbmssIC5zaWRlYmFyIC5tYWluLW1lbnUgLnN1Yi1tZW51JywgZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRzdWJNZW51LnJlbW92ZUNsYXNzKCd0by10b3AnKTtcclxuXHR9KTtcclxuXHJcblx0ZnVuY3Rpb24gdG9Ub3AoZWxlbWVudCkge1xyXG5cdFx0c3ViTWVudSA9ICQoZWxlbWVudCkuY2xvc2VzdCgnbGknKS5maW5kKCcuc3ViLW1lbnUnKTtcclxuXHJcblx0XHRpZiAoIHN1Yk1lbnUubGVuZ3RoICYmIHN1Yk1lbnUub2Zmc2V0KCkudG9wICsgc3ViTWVudS5oZWlnaHQoKSA+IHNpZGViYXIub2Zmc2V0KCkudG9wICsgc2lkZWJhci5oZWlnaHQoKSApXHJcblx0XHRcdHN1Yk1lbnUuYWRkQ2xhc3MoJ3RvLXRvcCcpO1xyXG5cdH1cclxuXHJcbn0pKCk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
